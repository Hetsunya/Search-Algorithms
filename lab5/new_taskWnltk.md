Давайте подробно разберем вывод кода, чтобы понять, что он показывает и как интерпретировать результаты. Код реализует поиск документов по запросам с использованием двух методов: TF-IDF и простого подсчета вхождений слов, а также оценивает их качество и сравнивает производительность. Вывод разбит на несколько секций, и я объясню каждую из них.

---

### 1. Подготовка данных
```
Подготовка данных завершена за 1.8757 секунд
Размер словаря: 7204 слов
Количество документов: 10
```
- **Подготовка данных завершена за 1.8757 секунд**: Время, затраченное на загрузку 10 текстовых файлов из папки `kniga`, их предобработку (токенизацию, стемминг, удаление стоп-слов), построение TF-матрицы, вычисление IDF и создание TF-IDF матрицы.
- **Размер словаря: 7204 слов**: Количество уникальных слов (после стемминга) во всех документах. Например, "затрепетали" и "затрепета" считаются одним словом "затрепета".
- **Количество документов: 10**: В папке `kniga` найдено 10 файлов с расширением `.txt` (например, `часть_1.txt`, `часть_2.txt`, ..., `часть_10.txt`).

---

### 2. Сгенерированные релевантные документы
```
Сгенерированные релевантные документы:
  Запрос: "затрепетали на ветру знамена", релевантные документы: ['часть_8.txt']
  Запрос: "Фродо кольцо", релевантные документы: ['часть_1.txt', 'часть_10.txt', 'часть_3.txt', 'часть_5.txt', 'часть_6.txt', 'часть_7.txt', 'часть_8.txt', 'часть_9.txt']
  Запрос: "рохиррим", релевантные документы: ['часть_1.txt', 'часть_2.txt', 'часть_3.txt', 'часть_4.txt', 'часть_5.txt', 'часть_8.txt']
```
- Это результат работы функции `generate_relevant_docs`. Для каждого запроса определяется список документов, которые содержат **все слова запроса** после предобработки (стемминга).
  - **"затрепетали на ветру знамена"**: Только `часть_8.txt` содержит все слова ("затрепета", "ветр", "знам").
  - **"Фродо кольцо"**: 8 документов содержат оба слова ("фрод", "кольц"), что указывает на их частое совместное упоминание.
  - **"рохиррим"**: 6 документов содержат слово "рохирр".
- Эти списки используются как "золотой стандарт" для оценки качества поиска (precision, recall, F1).

---

### 3. Анализ запроса: "затрепетали на ветру знамена"
```
=== Анализ запроса: "затрепетали на ветру знамена" ===
Query vector for 'затрепетали на ветру знамена': {'затрепета': 0.7675283643313486, 'ветр': 0.11889164797957746, 'знам': 0.11889164797957746}
```
- **Query vector**: TF-IDF вектор запроса.
  - Запрос разбивается на токены: "затрепета", "ветр", "знам" (после стемминга).
  - TF для каждого слова: \(1/3 \approx 0.333\) (3 слова в запросе).
  - IDF умножается на TF:
    - "затрепета": встречается реже, IDF выше (\(\approx 2.303\)), TF-IDF = \(0.333 \cdot 2.303 \approx 0.767\).
    - "ветр" и "знам": встречаются чаще, IDF ниже (\(\approx 0.357\)), TF-IDF = \(0.333 \cdot 0.357 \approx 0.119\).

#### TF-IDF ранжирование
```
TF-IDF ранжирование:
  Всего документов: 10
  Документ: часть_8.txt, косинусное сходство: 0.0351
  Документ: часть_4.txt, косинусное сходство: 0.0088
  Документ: часть_5.txt, косинусное сходство: 0.0052
  Документ: часть_1.txt, косинусное сходство: 0.0049
  Документ: часть_7.txt, косинусное сходство: 0.0040
  Время выполнения: 0.003748 секунд
```
- **Всего документов: 10**: Все документы ранжируются.
- **Косинусное сходство**: Показывает, насколько TF-IDF вектор документа близок к вектору запроса.
  - `часть_8.txt` (0.0351): самый релевантный, так как содержит все слова запроса с учетом их значимости (TF-IDF).
  - Другие документы содержат часть слов, но их вес меньше.
- **Время выполнения**: 0.003748 сек — время на вычисление TF-IDF вектора запроса и сравнение с 10 документами.

#### Простой подсчет встречаемости
```
Простой подсчёт встречаемости:
  Всего документов: 10
  Документ: часть_4.txt, вхождений: 16
  Документ: часть_8.txt, вхождений: 16
  Документ: часть_7.txt, вхождений: 9
  Документ: часть_1.txt, вхождений: 8
  Документ: часть_5.txt, вхождений: 8
  Время выполнения: 0.002072 секунд
```
- **Вхождений**: Сумма числа вхождений слов запроса ("затрепета", "ветр", "знам") в каждом документе.
  - `часть_4.txt` и `часть_8.txt`: по 16 вхождений, но порядок случайный (нет учета значимости слов).
- **Время выполнения**: 0.002072 сек — быстрее, так как просто считает вхождения без сложных вычислений.

#### Оценка качества (TF-IDF)
```
Оценка качества (TF-IDF):
  Релевантных документов в корпусе: 1
  Найдено релевантных: 1
  Precision: 0.1000
  Recall: 1.0000
  F1-score: 0.1818
```
- **Релевантных в корпусе**: 1 (`часть_8.txt`).
- **Найдено релевантных**: 1 (TF-IDF нашел `часть_8.txt`).
- **Precision**: \(1/10 = 0.1\) — из 10 найденных только 1 релевантный.
- **Recall**: \(1/1 = 1.0\) — все релевантные найдены.
- **F1-score**: \(2 \cdot (0.1 \cdot 1.0) / (0.1 + 1.0) = 0.1818\) — баланс между точностью и полнотой.

#### Сравнительный анализ
```
Сравнительный анализ:
  Пересечение топ-5 (TF-IDF и простой): 5 документов
  Уникальные для TF-IDF: set()
  Уникальные для простого подсчёта: set()
```
- **Пересечение топ-5**: Топ-5 документов совпадают, но в разном порядке.
- **Уникальные**: Нет различий в составе топ-5, только в ранжировании.

---

### 4. Анализ запроса: "Фродо кольцо"
```
=== Анализ запроса: "Фродо кольцо" ===
Query vector for 'Фродо кольцо': {'фрод': 0.052680257828913175, 'кольц': 0.052680257828913175}
```
- **Query vector**: TF = \(1/2 = 0.5\), IDF для "фрод" и "кольц" низкий (\(\approx 0.105\)), так как они встречаются во многих документах.

#### TF-IDF ранжирование
```
TF-IDF ранжирование:
  Документ: часть_7.txt, косинусное сходство: 0.0786
  Документ: часть_6.txt, косинусное сходство: 0.0637
  Документ: часть_8.txt, косинусное сходство: 0.0521
  Документ: часть_10.txt, косинусное сходство: 0.0519
  Документ: часть_9.txt, косинусное сходство: 0.0285
```
- `часть_7.txt` лидирует, так как слова "фрод" и "кольц" имеют больший вес в этом документе.

#### Простой подсчет
```
Простой подсчёт встречаемости:
  Документ: часть_7.txt, вхождений: 127
  Документ: часть_10.txt, вхождений: 112
  Документ: часть_6.txt, вхождений: 103
```
- Порядок тот же, но значения показывают частоту, а не значимость.

#### Оценка качества
```
Оценка качества (TF-IDF):
  Релевантных документов в корпусе: 8
  Найдено релевантных: 8
  Precision: 0.8000
  Recall: 1.0000
  F1-score: 0.8889
```
- **Precision**: \(8/10 = 0.8\) — 8 из 10 релевантны.
- **Recall**: \(8/8 = 1.0\) — все релевантные найдены.
- **F1**: Высокое значение из-за хорошего баланса.

---

### 5. Анализ запроса: "рохиррим"
```
Query vector for 'рохиррим': {'рохирр': 0.5108256237659907}
```
- Одно слово, IDF выше (\(\approx 1.022\)), так как встречается в 6 документах.

#### TF-IDF ранжирование
```
TF-IDF ранжирование:
  Документ: часть_4.txt, косинусное сходство: 0.0519
  Документ: часть_2.txt, косинусное сходство: 0.0315
```
- `часть_4.txt` лидирует из-за большего веса "рохирр".

#### Простой подсчет
```
Простой подсчёт встречаемости:
  Документ: часть_4.txt, вхождений: 10
  Документ: часть_2.txt, вхождений: 5
```

#### Оценка качества
```
Оценка качества (TF-IDF):
  Precision: 0.6000
  Recall: 1.0000
  F1-score: 0.7500
```
- **Precision**: \(6/10 = 0.6\).
- **Recall**: \(6/6 = 1.0\).
- **F1**: Хороший результат.

---

### Основные выводы
1. **TF-IDF**:
   - Учитывает значимость слов (IDF), поэтому лучше ранжирует релевантные документы (например, `часть_8.txt` на первом месте для первого запроса).
   - Медленнее из-за вычислений косинусного сходства.

2. **Простой подсчет**:
   - Быстрее, но ранжирует только по частоте, что менее точно (например, `часть_4.txt` на первом месте для первого запроса, хотя он не релевантен).
   - Может переоценивать документы с частыми, но менее значимыми словами.

3. **Качество**:
   - TF-IDF показывает высокую полноту (Recall = 1.0), но точность (Precision) зависит от числа релевантных документов.